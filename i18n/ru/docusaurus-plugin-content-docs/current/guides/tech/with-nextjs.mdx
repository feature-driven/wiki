---
sidebar_position: 10
---
# Использование с NextJS

NextJS хорошо работает с FSD, но возникают конфликты из-за различий между требованиями к структуре проекта NextJS и принципами FSD.
А именно, в двух пунктах: 

- Маршрутизация файлов в слое `pages`
- Конфликт или отсутствие слоя `app` в NextJS

## Конфликт между FSD и NextJS в слое `pages` {#pages-conflict}

NextJS предлагает использовать папку `pages` для определения маршрутов приложения. По умолчанию NextJS ожидает, что файлы в папке `pages` будут соответствовать определенным URL-адресам.
Этот механизм маршрутизации **не соответствует** концепции FSD, поскольку в таком механизме маршрутизации не представляется возможным соблюсти плоскую структуру слайсов.

### Перемещение папки `pages` NextJS в корневую папку проекта (рекомендуется)

Подход заключается в перемещении папки `pages` NextJS в корневую папку проекта, сохраняя
при этом структуру проекта FSD внутри папки `src`, и импорте страниц FSD в папку `pages` NextJS.

```sh
├── pages              # Папка pages (NextJS)
├── src
│   ├── app
│   ├── entities
│   ├── features  
│   ├── pages          # Папка pages (FSD)
│   ├── shared
│   ├── widgets
```

### Переименование папки `pages` в структуре FSD

Другой способ решить проблему - переименовать слой `app` в структуре FSD, чтобы избежать конфликтов с папкой `pages` NextJS.
Вам следует переименовать слой `app` в FSD в `views`. 
Таким образом, структура проекта в папке `src` будет сохранена, не вступая в противоречие с требованиями NextJS.

```sh
├── app
├── entities
├── features  
├── pages              # Папка pages (NextJS)
├── views              # Переименованная папка страниц FSD
├── shared
├── widgets             
```

__Оба подхода к разрешению конфликтов также предполагают использование [группирования маршрутов](https://nextjs.org/docs/app/building-your-application/routing/route-groups) при наличии большого количества страниц.__

## Отсутствие папки `app` в NextJS {#app-absence}

В NextJS ниже версии 13 нет явной папки `app`, вместо этого NextJS предоставляет файл `_app.tsx`,
который играет роль общего компонента обертывания для всех страниц проекта.

### Импорт функциональности в `pages/_app.tsx`

Чтобы решить проблему отсутствия папки `app` в структуре NextJS, вам следует создать компонент `App` внутри слоя `app` и импортировать его в `pages/_app.tsx`, чтобы NextJS мог с ним работать.
Например:

```tsx
// app/providers/index.tsx

const App = ({ Component, pageProps }: AppProps) => {
  return (
    <Provider1>
      <Provider2>
        <BaseLayout>
            <Component {...pageProps} />
        </BaseLayout>
      </Provider2>
    </Provider1>
  );
};

export default App;
```
Необходимо импортировать созданный компонент `App` и глобальные стили проекта в `pages/_app.tsx` следующим образом:

```tsx
// pages/_app.tsx

import 'app/styles/index.scss'

export { default } from 'app';
```

## Работа с App Router {#app-router}

App Router стал стабильным в NextJS версии 13.4. App Router позволяет использовать папку `app` для маршрутизации вместо папки `pages`.
Чтобы соответствовать принципам FSD, вам следует обращаться с папкой `app` NextJS таким же образом, как рекомендуется
для устранения конфликта с папкой `pages` NextJS.

Подход заключается в перемещении папки `app` NextJS в корневую папку проекта, сохраняя
при этом структуру FSD внутри папки `src`, и импорте страниц FSD в папку `app` NextJS.

```sh
├── app                # Папка app (NextJS)
├── src
│   ├── app            # Папка app (FSD)
│   ├── entities
│   ├── features  
│   ├── pages
│   ├── shared
│   ├── widgets
```

__Этот подход также предполагает использование [группирования маршрутов](https://nextjs.org/docs/app/building-your-application/routing/route-groups) при наличии большого количества страниц.__

## См. также {#see-also}

- [(Тред) Про pages директорию в NextJS](https://t.me/feature_sliced/3623)
